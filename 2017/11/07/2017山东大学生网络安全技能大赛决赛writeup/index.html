<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    
    <title>2017山东大学生网络安全技能大赛决赛writeup.md | 1ABlades&#39; blog</title>
    
    <link rel="alternative" href="/atom.xml" title="1ABlades&#39; blog" type="application/atom+xml">
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/libs/fancybox/jquery.fancybox.css" charset="utf-8">
    
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="site">
    <header class="site-header">
        <h1 class="site-title"><a href="/">1ABlades&#39; blog</a></h1>
        <nav class="site-nav">
            <ul class="nav">
                
                <li><a href="/archives">Archives</a></li>
                
                
                <li><a href="/atom.xml" title="RSS Feed">rss</a></li>
                
                <li><a class="toggle-search" href="#search">search</a></li>
            </ul>
        </nav>
        <div class="site-search" id="search">
            <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="1ablades.github.io"></form>
        </div>
        
            <div class="site-header-background" style="background-image:url(http://reumia.github.io/hexo-theme-zzoman2015/images/background-zzoman2015.jpg)"></div>
        
    </header>
    <div class="site-body">
        <div class="global-width">
    <article class="article" data-layout="post" data-slug="2017山东大学生网络安全技能大赛决赛writeup">
        <div class="article-content">
            
            
            <header class="article-header">
                <div class="article-meta">
                    <a href="/2017/11/07/2017山东大学生网络安全技能大赛决赛writeup/" class="article-date">
  <time datetime="2017-11-07T08:41:53.000Z">2017-11-07</time>
</a>
                    
                    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/">writeup</a></li></ul>

                </div>
                
    <h1 class="article-title" itemprop="name">
      <a href="/2017/11/07/2017山东大学生网络安全技能大赛决赛writeup/">2017山东大学生网络安全技能大赛决赛writeup.md</a>
    </h1>

            </header>
            
            <div class="article-body">
                <p>部分题目writeup</p>
<h3 id="base家族"><a href="#base家族" class="headerlink" title="base家族"></a>base家族</h3><p>base32和64交替加密，脚本泡一下<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">import base64</div><div class="line"></div><div class="line"><span class="attribute">f</span>=open("base.txt","r")</div><div class="line"><span class="attribute">s</span>=f.read()</div><div class="line">f.close()</div><div class="line"></div><div class="line"><span class="keyword">while</span> <span class="literal">True</span>:</div><div class="line">    <span class="keyword">if</span> <span class="string">"flag"</span> <span class="keyword">in</span> s:</div><div class="line">        break</div><div class="line">    try:</div><div class="line">        <span class="attribute">s</span>=base64.b32decode(s)</div><div class="line">    except:</div><div class="line">        <span class="attribute">s</span>=base64.b64decode(s)</div><div class="line"></div><div class="line"><span class="builtin-name">print</span> s</div></pre></td></tr></table></figure></p>
<h3 id="gakki"><a href="#gakki" class="headerlink" title="gakki"></a>gakki</h3><p>利用winhex修改一下图片大小</p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171106/i30CHgl6d2.png" alt="mark"></p>
<p>即可得到flag</p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171106/GkAH7kJf4A.png" alt="mark"></p>
<h3 id="hacker"><a href="#hacker" class="headerlink" title="hacker"></a>hacker</h3><p>用stegsolve可得到二维码<br>扫描得到flag</p>
<h3 id="磁盘镜像"><a href="#磁盘镜像" class="headerlink" title="磁盘镜像"></a>磁盘镜像</h3><p>binwalk了一下发现有图片<br>foremost分离出来即可得到flag</p>
<h3 id="黑客留下的机密信息"><a href="#黑客留下的机密信息" class="headerlink" title="黑客留下的机密信息"></a>黑客留下的机密信息</h3><p>分析流量包可知黑客上传了shell<br>有一条流量<br><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171106/LHJ31gKDb9.png" alt="mark"><br>z2的值base64解一下就是flag</p>
<h3 id="机密信息"><a href="#机密信息" class="headerlink" title="机密信息"></a>机密信息</h3><p>apache的日志，用apachelogview看一下，发现是盲注<br>注入得到的字符串就是flag</p>
<h3 id="颜文字"><a href="#颜文字" class="headerlink" title="颜文字"></a>颜文字</h3><p>放到浏览器console运行一下</p>
<h3 id="小明的生日"><a href="#小明的生日" class="headerlink" title="小明的生日"></a>小明的生日</h3><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">-*- coding:utf<span class="number">-8</span> -*-</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line">s = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> i in range(<span class="number">1</span>,<span class="number">13</span>):</div><div class="line">    <span class="keyword">for</span> j in range(<span class="number">1</span>,<span class="number">32</span>):</div><div class="line"></div><div class="line">        <span class="keyword">if</span> i &lt; <span class="number">10</span>:</div><div class="line">            i=<span class="string">'0'</span>+<span class="built_in">str</span>(i)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            i=<span class="built_in">str</span>(i)</div><div class="line">        <span class="keyword">if</span> j &lt; <span class="number">10</span>:</div><div class="line">            j = <span class="string">'0'</span>+<span class="built_in">str</span>(j)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            j=<span class="built_in">str</span>(j)</div><div class="line">        <span class="built_in">key</span>=<span class="string">"1997"</span>+i+j</div><div class="line">        <span class="built_in">print</span> <span class="built_in">key</span></div><div class="line">        md5 = hashlib.md5(<span class="built_in">key</span>).hexdigest()</div><div class="line">        <span class="keyword">if</span> <span class="string">'0175501585710a89'</span> in md5:</div><div class="line">            <span class="built_in">print</span> <span class="built_in">key</span></div><div class="line">            <span class="built_in">print</span> md5</div></pre></td></tr></table></figure>
<h3 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h3><p>解密脚本<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="built_in">import</span> sys</div><div class="line"></div><div class="line"><span class="attr">s</span> = raw_input('String:\n')</div><div class="line"><span class="attr">a</span> = input('a:\n')</div><div class="line"><span class="attr">b</span> = input('b:\n')</div><div class="line"></div><div class="line"><span class="keyword">if</span> <span class="attr">a==1:</span></div><div class="line">    <span class="attr">aa=1</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==3:</span></div><div class="line">    <span class="attr">aa=9</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==5:</span></div><div class="line">    <span class="attr">aa=21</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==7:</span></div><div class="line">    <span class="attr">aa=15</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==9:</span></div><div class="line">    <span class="attr">aa=3</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==11:</span></div><div class="line">    <span class="attr">aa=19</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==15:</span></div><div class="line">    <span class="attr">aa=7</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==17:</span></div><div class="line">    <span class="attr">aa=23</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==19:</span></div><div class="line">    <span class="attr">aa=11</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==21:</span></div><div class="line">    <span class="attr">aa=5</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==23:</span></div><div class="line">    <span class="attr">aa=17</span></div><div class="line"><span class="keyword">if</span> <span class="attr">a==25:</span></div><div class="line">    <span class="attr">aa=25</span></div><div class="line"></div><div class="line">for c <span class="keyword">in</span> s:</div><div class="line">    <span class="attr">c=chr((aa*(ord(c)-97-b))%26+97)</span></div><div class="line">    sys.stdout.write(c)</div></pre></td></tr></table></figure></p>
<h3 id="神奇的二维码"><a href="#神奇的二维码" class="headerlink" title="神奇的二维码"></a>神奇的二维码</h3><p>解密脚本<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*- coding:utf-8 -*-</span></div><div class="line"><span class="built_in">from</span> PIL import Image</div><div class="line">import re</div><div class="line"></div><div class="line">x = <span class="number">280</span> <span class="comment">#x坐标  通过对txt里的行数进行整数分解</span></div><div class="line">y = <span class="number">280</span> <span class="comment">#y坐标  x*y = 行数</span></div><div class="line"></div><div class="line">im = Image.<span class="built_in">new</span>(<span class="string">"RGB"</span>,(x,y))<span class="comment">#创建图片</span></div><div class="line"><span class="built_in">file</span> = <span class="built_in">open</span>(<span class="string">'flag.txt'</span>) <span class="comment">#打开rbg值文件</span></div><div class="line"></div><div class="line"><span class="comment">#通过一个个rgb点生成图片</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,x):</div><div class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,y):</div><div class="line">        <span class="built_in">line</span> = <span class="built_in">file</span>.readline()<span class="comment">#获取一行</span></div><div class="line">        rgb = <span class="built_in">line</span>.<span class="built_in">split</span>(<span class="string">","</span>)<span class="comment">#分离rgb</span></div><div class="line">        im.putpixel((i,j),(int(rgb[<span class="number">0</span>]),int(rgb[<span class="number">1</span>]),int(rgb[<span class="number">2</span>])))<span class="comment">#rgb转化为像素</span></div><div class="line">im.show()</div></pre></td></tr></table></figure></p>
<p>扫描二维码得到一传base64，然后栅栏解密，最后rot13</p>
<h3 id="神奇的图片"><a href="#神奇的图片" class="headerlink" title="神奇的图片"></a>神奇的图片</h3><p>提示了异或，脚本：<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">20</span>):</div><div class="line">    flag_png=<span class="built_in">open</span>(<span class="string">"flag.png"</span>,<span class="string">"rb"</span>).<span class="built_in">read</span>(i)</div><div class="line">    png_key=<span class="built_in">open</span>(<span class="string">"xor.png"</span>,<span class="string">"rb"</span>).<span class="built_in">read</span>(i)</div><div class="line">    key=<span class="string">''</span>.join(chr(ord(<span class="keyword">a</span>)^ord(b)) <span class="keyword">for</span> <span class="keyword">a</span>,b <span class="keyword">in</span> zip(png_key,flag_png))</div><div class="line">    print key</div></pre></td></tr></table></figure></p>
<h3 id="铜牌靶机LFI"><a href="#铜牌靶机LFI" class="headerlink" title="铜牌靶机LFI"></a>铜牌靶机LFI</h3><p>伪协议，?key=php://filter/convert.base64-encode/resource=index 可以读任意php文件<br>文件泄露.DS_store，从文件中可知flag文件，利用伪协议读出</p>

            </div>
        </div>
    </article>

    
    
<nav class="article-nav">
  
    <a href="/2017/12/03/2017湖湘杯writeup/" id="article-nav-newer" class="article-nav-link-wrap prev">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          2017湖湘杯writeup
        
      </div>
    </a>
  
  
    <a href="/2017/08/10/欧几里德算法及扩展算法/" id="article-nav-older" class="article-nav-link-wrap next">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">欧几里德算法及扩展算法</div>
    </a>
  
</nav>

    

    
</div>
    </div>
    <footer class="site-footer">
        <div class="global-width">
            <ul class="site-widget">
                
                <li class="widget widget-tag">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/">CTF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web安全/">Web安全</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/writeup/">writeup</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/密码学/">密码学</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-category">
                    
                </li>
                
                <li class="widget widget-recent_posts">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-body">
      <ul>
        
          <li>
            <a href="/2017/12/03/2017湖湘杯writeup/">2017湖湘杯writeup</a>
          </li>
        
          <li>
            <a href="/2017/11/07/2017山东大学生网络安全技能大赛决赛writeup/">2017山东大学生网络安全技能大赛决赛writeup.md</a>
          </li>
        
          <li>
            <a href="/2017/08/10/欧几里德算法及扩展算法/">欧几里德算法及扩展算法</a>
          </li>
        
          <li>
            <a href="/2017/08/09/RSA共模攻击/">RSA共模攻击</a>
          </li>
        
          <li>
            <a href="/2017/08/08/hexo-github-blog搭建/">hexo+github blog搭建</a>
          </li>
        
      </ul>
    </div>
  </div>

                </li>
                
            </ul>
        </div>
        <div class="site-info">
            <address>
                &copy; 2014 <a href="1ablades.github.io">1ABlades&#39; blog</a> All Right Reserved. <br/>
                Powered by <a href="http://hexo.io">Hexo</a>. Theme by <a href="http://zzoman.com">ZZOMAN</a>
            </address>
        </div>
    </footer>
    
    <script src="/libs/jquery-1.11.3.min.js" type="text/javascript"></script>
    
    <script src="/libs/fancybox/jquery.fancybox.js" type="text/javascript"></script>
    
    <script src="/js/site_init.js" type="text/javascript"></script>
    
</body>
</html>
